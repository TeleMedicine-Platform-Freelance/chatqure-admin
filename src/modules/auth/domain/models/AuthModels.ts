/**
 * Auth Domain Models
 * 
 * Core domain entities and value objects for authentication
 */

// ============================================================================
// Entities
// ============================================================================

export type Role = 'admin' | 'editor' | 'viewer';

export interface AuthUser {
  id: string;
  email?: string; // Optional for admin users (may use phone number)
  phoneNumber?: string; // Phone number for admin users
  name: string;
  roles: Role[];
  avatar?: string;
  emailVerified?: boolean;
  createdAt?: string;
}

export interface AuthTokens {
  accessToken: string;
  refreshToken: string;
  expiresIn?: number; // seconds
}

// ============================================================================
// DTOs (Data Transfer Objects)
// ============================================================================

export interface LoginDTO {
  email: string;
  password: string;
  remember?: boolean;
}

export interface SendOtpDTO {
  phoneNumber: string;
  role: string; // "ADMIN" for admin users
}

export interface VerifyOtpDTO {
  phoneNumber: string;
  otp: string;
  role?: string; // Optional, uses stored role if not provided
}

export interface RegisterDTO {
  email: string;
  password: string;
  name: string;
  confirmPassword?: string;
}

export interface ForgotPasswordDTO {
  email: string;
}

export interface ResetPasswordDTO {
  token: string;
  password: string;
  confirmPassword?: string;
}

export interface VerifyEmailDTO {
  token: string;
}

export interface MfaSetupDTO {
  userId: string;
}

export interface MfaVerifyDTO {
  code: string;
  userId?: string;
}

export interface RefreshTokenDTO {
  refreshToken: string;
}

export interface ChangePasswordDTO {
  currentPassword: string;
  newPassword: string;
  confirmPassword?: string;
}

// ============================================================================
// API Response Types
// ============================================================================

export interface LoginResponse {
  user: AuthUser;
  accessToken: string;
  refreshToken: string;
  expiresIn?: number;
}

export interface RegisterResponse {
  user: AuthUser;
  accessToken: string;
  refreshToken: string;
  message?: string;
}

export interface ForgotPasswordResponse {
  message: string;
  resetToken?: string; // Only in dev/test
}

export interface ResetPasswordResponse {
  message: string;
}

export interface VerifyEmailResponse {
  message: string;
  user?: AuthUser;
}

export interface MfaSetupResponse {
  secret: string;
  qrCode: string;
  backupCodes?: string[];
}

export interface MfaVerifyResponse {
  message: string;
  accessToken: string;
}

export interface RefreshTokenResponse {
  accessToken: string;
  refreshToken: string;
  expiresIn?: number;
}

export interface LogoutResponse {
  message: string;
}

export interface MeResponse {
  user: AuthUser;
}

// ============================================================================
// Error Types
// ============================================================================

export interface AuthError {
  error: string;
  message: string;
  statusCode?: number;
  field?: string;
}

// ============================================================================
// Auth State
// ============================================================================

export interface AuthState {
  user: AuthUser | null;
  tokens: AuthTokens | null;
  isAuthenticated: boolean;
  isLoading: boolean;
  error: AuthError | null;
}
