import type {
  AuthUser,
  Role,
  LoginDTO,
  RegisterDTO,
  ForgotPasswordDTO,
  ResetPasswordDTO,
  VerifyEmailDTO,
  MfaSetupDTO,
  MfaVerifyDTO,
  RefreshTokenDTO,
  SendOtpDTO,
  VerifyOtpDTO,
} from '@/modules/auth/domain/models/AuthModels';

// Re-export for backward compatibility
export type { AuthUser, Role, LoginDTO };

export interface IAuthService {
  // Authentication
  login(dto: LoginDTO): Promise<AuthUser>;
  sendOtp(dto: SendOtpDTO): Promise<{ expiresIn: number; message: string; testOtp?: string }>;
  verifyOtp(dto: VerifyOtpDTO): Promise<AuthUser>;
  register(dto: RegisterDTO): Promise<AuthUser>;
  logout(): Promise<void>;
  
  // Password Management
  forgotPassword(dto: ForgotPasswordDTO): Promise<void>;
  resetPassword(dto: ResetPasswordDTO): Promise<void>;
  
  // Email Verification
  verifyEmail(dto: VerifyEmailDTO): Promise<void>;
  
  // MFA
  setupMfa(dto: MfaSetupDTO): Promise<{ secret: string; qrCode: string }>;
  verifyMfa(dto: MfaVerifyDTO): Promise<void>;
  
  // Token Management
  refreshToken(dto: RefreshTokenDTO): Promise<void>;
  
  // User State
  getCurrentUser(): AuthUser | null;
  isAuthenticated(): boolean;
  hasAnyRole(roles: Role[]): boolean;
  hasAllRoles(roles: Role[]): boolean;
  
  // Session Management
  clearSession(): void;
}
